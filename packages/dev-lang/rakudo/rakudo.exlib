# Copyright 2009, 2010 Ingmar Vanhassel
# Distributed under the terms of the GNU General Public License v2

export_exlib_phases src_configure #XXX src_test_expensive

SUMMARY="An implementation of Perl 6 on the Parrot Virtual Machine"
HOMEPAGE="http://rakudo.org/"

LICENCES="Artistic-2.0"
SLOT="0"
MYOPTIONS="vim-syntax"

DEPENDENCIES="
    build:
        dev-lang/perl[=5*&>=5.8.0]
    build+run:
        dev-lang/parrot
        dev-libs/icu
    suggestion:
        vim-syntax? ( app-vim/vim-perl ) [[ description = [ Vim syntax highlighting for perl6 ] ]]
"

UPSTREAM_CHANGELOG="http://github.com/rakudo/rakudo/commits/master"

DEFAULT_SRC_INSTALL_EXTRA_SUBDIRS=( docs )
DEFAULT_SRC_INSTALL_EXTRA_DOCS=( docs/ROADMAP docs/announce/2009-{02..12} \
    docs/announce/2010-{01..12} docs/announce/2011-01)

run_configure() {
    edo perl Configure.pl "${@}"
}

rakudo_src_configure() {
    run_configure
}

# We run a default, sanity check in src_test(), as well as the parts of the
# official test suite that's expected to pass, optionally
# FIXME This checks out the specs via SVN, use scm-svn instead
rakudo_src_test_expensive() {
    emake spectest
}

