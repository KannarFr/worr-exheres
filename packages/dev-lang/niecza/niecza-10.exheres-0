# Copyright 2011 William Orr <will@worrbase.com>
# Distributed under the terms of the GNU General Public License v2

require scm-git [ repository="git://github.com/sorear/niecza.git" tag=v10 ]

SUMMARY="A Perl 6 compiler targetting the CLR"
DESCRIPTION="
A Perl 6 compiler targetting the CLR with an experimental focus on optimizations
"
HOMEPAGE="https://github.com/sorear/niecza"

LICENCES="Artistic"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS=""

DEPENDENCIES="
    build+run:
        dev-lang/mono[>=2.6.4]
"

BUGS_TO="will@worrbase.com"

src_unpack() {
    dodir "${WORK}"
    [[ -n "${ARCHIVES}" ]] && unzip "${FETCHEDDIR}/${ARCHIVES}" -d "${WORK}"
}

src_install() {
    diropts "-m0777"
    dodir "/usr/${LIBDIR}/${PN}" "/usr/${LIBDIR}/${PN}/run" "/usr/${LIBDIR}/${PN}/obj"

    insinto "/usr/${LIBDIR}/${PN}/run"
    for lib in $(ls "${WORK}/run"); do
        doins "${WORK}/run/${lib}"
    done

    insinto "/usr/${LIBDIR}/${PN}/obj"
    for lib in $(ls "${WORK}/obj"); do
        doins "${WORK}/obj/${lib}"
    done

    insinto "/usr/${LIBDIR}/${PN}/lib"
    for lib in $(ls "${WORK}/lib"); do
        doins "${WORK}/lib/${lib}"
    done

    default
}
