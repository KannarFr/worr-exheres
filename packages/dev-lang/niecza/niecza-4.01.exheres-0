# Copyright 2011 William Orr <will@worrbase.com>
# Distributed under the terms of the GNU General Public License v2

SUMMARY="A Perl 6 compiler targetting the CLR"
DESCRIPTION="
A Perl 6 compiler targetting the CLR with an experimental focus on optimizations
"
HOMEPAGE="https://github.com/sorear/niecza"
DOWNLOADS="https://github.com/downloads/sorear/niecza/niecza-4.01.zip"

LICENCES="Artistic"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS=""

DEPENDENCIES="
    build+run:
        dev-lang/mono[>=2.6.4]
"

BUGS_TO="will@worrbase.com"

src_unpack() {
    mkdir "${WORK}"
    [[ -n "${ARCHIVES}" ]] && unzip "${FETCHEDDIR}/${ARCHIVES}" -d "${WORK}"
}

src_install() {
    dodir "/usr/${LIBDIR:-lib}/${PN}"
    dodir "/usr/${LIBDIR:-lib}/${PN}/run"
    dodir "/usr/${LIBDIR:-lib}/${PN}/obj"
    chmod -R 777 "${IMAGE}/usr/${LIBDIR:-lib}/${PN}"

    insinto "/usr/${LIBDIR:-lib}/${PN}/run"
    for lib in $(ls "${WORK}/run"); do
        doins "${WORK}/run/${lib}"
    done

    insinto "/usr/${LIBDIR:-lib}/${PN}/obj"
    for lib in $(ls "${WORK}/obj"); do
        doins "${WORK}/obj/${lib}"
    done

    insinto "/usr/${LIBDIR:-lib}/${PN}/lib"
    for lib in $(ls "${WORK}/lib"); do
        doins "${WORK}/lib/${lib}"
    done

    default
}
